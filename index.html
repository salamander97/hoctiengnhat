<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå∏ H·ªçc ti·∫øng Nh·∫≠t c√πng Sakura üå∏</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Inline CSS ƒë·ªÉ tr√°nh l·ªói file external */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Noto Sans JP', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
            min-height: 100vh;
        }

        .hero-section {
            background: linear-gradient(135deg, #ff9a8b 0%, #ffecd2 40%, #a8e6cf 100%);
            min-height: 70vh;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-conic-gradient(from 0deg, transparent 0deg, rgba(255, 255, 255, 0.1) 5deg, transparent 10deg);
            animation: rotate 30s linear infinite;
        }

        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-title {
            font-size: 4rem;
            font-weight: 800;
            color: white;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
            margin-bottom: 10px;
        }

        .hero-subtitle {
            font-size: 2rem;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 20px;
            font-weight: 600;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .hero-description {
            font-size: 1.3rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 30px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .user-section {
            margin-top: 30px;
        }

        .welcome-message {
            background: rgba(255, 255, 255, 0.2);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .login-prompt {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-login {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-login:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            color: white;
        }

        .menu-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: 280px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .menu-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
        }

        .menu-icon {
            font-size: 4rem;
            margin-bottom: 15px;
            display: block;
            position: relative;
            z-index: 2;
        }

        .menu-card h3 {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
        }

        .menu-card p {
            color: #6c757d;
            font-size: 1rem;
            line-height: 1.5;
            margin-bottom: 15px;
            position: relative;
            z-index: 2;
        }

        .menu-arrow {
            font-size: 1.5rem;
            color: #667eea;
            font-weight: bold;
            position: relative;
            z-index: 2;
            transition: transform 0.3s ease;
        }

        .menu-card:hover .menu-arrow {
            transform: translateX(10px);
        }

        .progress-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 3;
            box-shadow: 0 2px 8px rgba(86, 171, 47, 0.3);
        }

        .coming-soon-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 3;
            box-shadow: 0 2px 8px rgba(240, 147, 251, 0.3);
        }

        .menu-card.coming-soon {
            background: rgba(200, 200, 200, 0.3);
            cursor: not-allowed;
            filter: grayscale(50%);
        }

        .menu-card.coming-soon:hover {
            transform: none;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .menu-card.coming-soon .menu-icon,
        .menu-card.coming-soon h3,
        .menu-card.coming-soon p {
            opacity: 0.6;
        }

        footer {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            margin-top: 50px;
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.4rem;
            }
            
            .menu-card {
                height: 220px;
                padding: 20px 15px;
                margin-bottom: 20px;
            }
            
            .menu-icon {
                font-size: 3rem;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Header v·ªõi hi·ªáu ·ª©ng hoa anh ƒë√†o -->
    <div class="hero-section">
        <div class="container text-center">
            <div class="hero-content">
                <h1 class="hero-title">üå∏ Â≠¶Áøí„ÅÆÂ∫≠ üå∏</h1>
                <h2 class="hero-subtitle">V∆∞·ªùn h·ªçc ti·∫øng Nh·∫≠t</h2>
                <p class="hero-description">C√πng nhau kh√°m ph√° th·∫ø gi·ªõi Hiragana, Katakana v√† con s·ªë m·ªôt c√°ch vui v·∫ª!</p>
                
                <!-- User info or login prompt -->
                <div id="userInfo" class="user-section">
                    <div id="welcomeUser" class="welcome-message d-none">
                        <h4>„Åì„Çì„Å´„Å°„ÅØ„ÄÅ<span id="username"></span>„Åï„ÇìÔºÅ</h4>
                        <p>H√¥m nay ch√∫ng ta h·ªçc g√¨ nh·ªâ? üìö</p>
                    </div>
                    <div id="loginPrompt" class="login-prompt">
                        <p>Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh h·ªçc t·∫≠p! ‚ú®</p>
                        <button class="btn btn-login" onclick="showLogin()">üîë ƒêƒÉng nh·∫≠p</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Menu -->
    <div class="container my-5">
        <div class="row" id="menuItems">
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="menu-card" data-page="hiragana-rules">
                    <div class="menu-icon">üå∏</div>
                    <h3>Quy t·∫Øc Hiragana</h3>
                    <p>H·ªçc c√°ch gh√©p √¢m Yoon m·ªôt c√°ch d·ªÖ hi·ªÉu</p>
                    <div class="menu-arrow">‚Üí</div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 mb-4">
                <div class="menu-card" data-page="hiragana-test">
                    <div class="menu-icon">‚úèÔ∏è</div>
                    <h3>Ki·ªÉm tra Hiragana</h3>
                    <p>Th·ª≠ th√°ch ki·∫øn th·ª©c Hiragana c·ªßa b·∫°n</p>
                    <div class="progress-badge">
                        <span id="hiragana-progress">0%</span>
                    </div>
                    <div class="menu-arrow">‚Üí</div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 mb-4">
                <div class="menu-card" data-page="katakana-test">
                    <div class="menu-icon">üéå</div>
                    <h3>Ki·ªÉm tra Katakana</h3>
                    <p>Th·ª≠ s·ª©c v·ªõi b·∫£ng ch·ªØ c√°i Katakana</p>
                    <div class="coming-soon-badge">S·∫Øp ra m·∫Øt</div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 mb-4">
                <div class="menu-card" data-page="number-test">
                    <div class="menu-icon">üî¢</div>
                    <h3>Ki·ªÉm tra S·ªë ƒë·∫øm</h3>
                    <p>H·ªçc c√°ch ƒë·∫øm s·ªë trong ti·∫øng Nh·∫≠t</p>
                    <div class="progress-badge">
                        <span id="number-progress">0%</span>
                    </div>
                    <div class="menu-arrow">‚Üí</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="menu-card" data-page="vocabulary-n5">
                    <div class="menu-icon">üìö</div>
                    <h3>T·ª´ v·ª±ng N5</h3>
                    <p>H·ªçc t·ª´ v·ª±ng theo 20 ch·ªß ƒë·ªÅ th·ª±c t·∫ø</p>
                    <div class="progress-badge">
                        <span id="vocabulary-progress">0%</span>
                    </div>
                    <div class="menu-arrow">‚Üí</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="menu-card" data-page="dashboard">
                    <div class="menu-icon">üìä</div>
                    <h3>Dashboard</h3>
                    <p>Xem ti·∫øn ƒë·ªô h·ªçc t·∫≠p v√† th·ªëng k√™ chi ti·∫øt</p>
                    <div class="menu-arrow">‚Üí</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius: 20px;">
                <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 20px 20px 0 0;">
                    <h5 class="modal-title">üîë ƒêƒÉng nh·∫≠p</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="padding: 30px;">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginUsername" class="form-label">T√™n ƒëƒÉng nh·∫≠p</label>
                            <input type="text" class="form-control" id="loginUsername" required>
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">M·∫≠t kh·∫©u</label>
                            <input type="password" class="form-control" id="loginPassword" required>
                        </div>
                        <div class="text-center">
                            <button type="submit" class="btn btn-login w-100">ƒêƒÉng nh·∫≠p</button>
                        </div>
                        <div id="loginError" class="alert alert-danger mt-3 d-none"></div>
                    </form>
                    
                    <div class="mt-4 p-3" style="background: #f8f9fa; border-radius: 10px;">
                        <h6>üß™ T√†i kho·∫£n test:</h6>
                        <p class="mb-1"><strong>Username:</strong> demo</p>
                        <p class="mb-0"><strong>Password:</strong> password</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-4">
        <div class="container">
            <p class="mb-0">üå∏ Ch√∫c v∆°Ã£ h·ªçc ti·∫øng Nh·∫≠t vui v·∫ª! „Åå„Çì„Å∞„Å£„Å¶ÔºÅüå∏</p>
            <p class="small text-muted">Made with ‚ù§Ô∏è for my wife Phuong Thao</p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Simple inline JavaScript to avoid external file errors
        let currentUser = null;
        
        // Show login modal
        function showLogin() {
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
            loginModal.show();
        }
        
        // Handle login form
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            const errorDiv = document.getElementById('loginError');
            const submitBtn = e.target.querySelector('button[type="submit"]');
            
            // Show loading
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>ƒêang x·ª≠ l√Ω...';
            submitBtn.disabled = true;
            errorDiv.classList.add('d-none');
            
            try {
                const formData = new FormData();
                formData.append('action', 'login');
                formData.append('username', username);
                formData.append('password', password);
                
                const response = await fetch('php/auth.php', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    currentUser = data.user;
                    
                    // Close modal
                    const modal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                    modal.hide();
                    
                    // Update UI
                    updateUI(true);
                    
                    // Show success message
                    showToast('ƒêƒÉng nh·∫≠p th√†nh c√¥ng! üéâ', 'success');
                    
                    // Reset form
                    e.target.reset();
                } else {
                    showError(errorDiv, data.message || 'T√™n ƒëƒÉng nh·∫≠p ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!');
                }
            } catch (error) {
                console.error('Login error:', error);
                showError(errorDiv, 'C√≥ l·ªói x·∫£y ra, vui l√≤ng th·ª≠ l·∫°i!');
            } finally {
                submitBtn.innerHTML = 'üîë ƒêƒÉng nh·∫≠p';
                submitBtn.disabled = false;
            }
        });
        
        // Update UI based on login status
        function updateUI(isLoggedIn) {
            const welcomeUser = document.getElementById('welcomeUser');
            const loginPrompt = document.getElementById('loginPrompt');
            const username = document.getElementById('username');
            
            if (isLoggedIn && currentUser) {
                welcomeUser.classList.remove('d-none');
                loginPrompt.classList.add('d-none');
                if (username) {
                    username.textContent = currentUser.display_name || currentUser.username;
                }
                
                // Enable menu items
                const menuItems = document.querySelectorAll('.menu-card:not(.coming-soon)');
                menuItems.forEach(item => {
                    item.style.filter = 'none';
                    item.style.pointerEvents = 'auto';
                });
                
                // Load user progress
                loadUserProgress();
            } else {
                welcomeUser.classList.add('d-none');
                loginPrompt.classList.remove('d-none');
                
                // Disable menu items
                const menuItems = document.querySelectorAll('.menu-card:not(.coming-soon)');
                menuItems.forEach(item => {
                    item.style.filter = 'grayscale(50%) opacity(0.7)';
                    item.style.pointerEvents = 'none';
                });
            }
        }
        
        // Show error message
        function showError(element, message) {
            if (element) {
                element.textContent = message;
                element.classList.remove('d-none');
            }
        }
        
        // Show toast notification
        function showToast(message, type = 'info') {
            // Create simple alert instead of complex toast
            const alertClass = type === 'success' ? 'success' : type === 'error' ? 'danger' : 'info';
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${alertClass} position-fixed top-0 start-50 translate-middle-x mt-3`;
            alertDiv.style.zIndex = '9999';
            alertDiv.innerHTML = message;
            
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 3000);
        }
        
        // Load user progress
        async function loadUserProgress() {
            if (!currentUser) return;
            
            try {
                const response = await fetch('php/user-progress.php?action=get');
                const data = await response.json();
                
                if (data.success) {
                    updateProgressBadges(data.progress);
                }
            } catch (error) {
                console.error('Error loading progress:', error);
            }
        }
        
        // Update progress badges
        function updateProgressBadges(progress) {
            if (progress) {
                document.getElementById('hiragana-progress').textContent = (progress.hiragana || 0) + '%';
                document.getElementById('number-progress').textContent = (progress.numbers || 0) + '%';
            }
        }
        
        // Initialize menu cards
        document.addEventListener('DOMContentLoaded', function() {
            // Initially disable menu items
            updateUI(false);
            
            // Add click handlers to menu cards
            const menuCards = document.querySelectorAll('.menu-card:not(.coming-soon)');
            menuCards.forEach(card => {
                card.addEventListener('click', function() {
                    if (currentUser) {
                        const page = this.getAttribute('data-page');
                        if (page) {
                            window.location.href = page + '.html';
                        }
                    } else {
                        showLogin();
                    }
                });
            });
            
            // Check if user is already logged in
            checkLoginStatus();
        });
        
        // Check login status on page load
        async function checkLoginStatus() {
            try {
                const response = await fetch('php/auth.php?action=check');
                const data = await response.json();
                
                if (data.success && data.user) {
                    currentUser = data.user;
                    updateUI(true);
                }
            } catch (error) {
                console.log('No active session');
                updateUI(false);
            }
        }
    </script>
</body>
</html>


